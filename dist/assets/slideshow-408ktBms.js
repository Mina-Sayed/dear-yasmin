const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/level2-Ds1W93bh.js","assets/index-CwZDPnQ5.js","assets/index-BuF_uRMX.css"])))=>i.map(i=>d[i]);
var c=Object.defineProperty;var a=(r,e,s)=>e in r?c(r,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[e]=s;var l=(r,e,s)=>a(r,typeof e!="symbol"?e+"":e,s);import{U as h,G as o,_ as m}from"./index-CwZDPnQ5.js";class p{constructor(e){l(this,"sm");l(this,"currentIndex",0);l(this,"timer",0);l(this,"slideDuration",5);l(this,"paused",!1);l(this,"pendingSlideIndex",null);l(this,"eventListeners",[]);this.sm=e}enter(){h.showScreen("slideshow-screen"),this.currentIndex=0,this.showSlide(0),this.eventListeners=[];const e=document.getElementById("slide-next"),s=document.getElementById("slide-prev"),t=document.getElementById("slide-finish"),d=document.getElementById("slideshow-content");if(e){const n=()=>{this.timer=0,this.nextSlide()};e.addEventListener("click",n),this.eventListeners.push({el:e,type:"click",handler:n})}else console.warn("Slideshow: nextBtn not found");if(s){const n=()=>{this.timer=0,this.prevSlide()};s.addEventListener("click",n),this.eventListeners.push({el:s,type:"click",handler:n})}else console.warn("Slideshow: prevBtn not found");if(t){const n=()=>{m(async()=>{const{Level2State:i}=await import("./level2-Ds1W93bh.js");return{Level2State:i}},__vite__mapDeps([0,1,2])).then(({Level2State:i})=>{this.sm.changeState(new i(this.sm))})};t.addEventListener("click",n),this.eventListeners.push({el:t,type:"click",handler:n})}else console.warn("Slideshow: finishBtn not found");if(d){const n=()=>this.paused=!0,i=()=>this.paused=!1;d.addEventListener("touchstart",n),d.addEventListener("touchend",i),d.addEventListener("mouseenter",n),d.addEventListener("mouseleave",i),this.eventListeners.push({el:d,type:"touchstart",handler:n},{el:d,type:"touchend",handler:i},{el:d,type:"mouseenter",handler:n},{el:d,type:"mouseleave",handler:i})}}showSlide(e){e<0&&(e=o.memories.length-1),e>=o.memories.length&&(e=0),this.currentIndex=e,this.pendingSlideIndex=e;const s=o.memories[e],t=document.getElementById("slide-img"),d=document.getElementById("slide-text"),n=document.getElementById("slide-progress");t&&(t.onload=null,t.onerror=null,t.style.opacity="0",setTimeout(()=>{this.pendingSlideIndex===e&&(t.onload=()=>{this.pendingSlideIndex===e&&(t.style.opacity="1")},t.onerror=()=>{this.pendingSlideIndex===e&&(t.src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDAiIGhlaWdodD0iMTAwIiB2aWV3Qm94PSIwIDAgMTAwIDEwMCI+PHJlY3Qgd2lkdGg9IjEwMCIgaGVpZ2h0PSIxMDAiIGZpbGw9IiNkZGQiLz48dGV4dCB4PSI1MCIgeT0iNTAiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIyMCIgZmlsbD0iIzU1NSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPk5vIEltYWdlPC90ZXh0Pjwvc3ZnPg==",t.style.opacity="1")},t.src=s.img)},200)),d&&(d.innerText=s.text),n&&(n.innerText=`${e+1} / ${o.memories.length}`);const i=document.getElementById("slide-finish");i&&(e===o.memories.length-1?(i.classList.remove("hidden"),i.style.display="block"):(i.classList.add("hidden"),i.style.display="none"))}nextSlide(){this.showSlide(this.currentIndex+1)}prevSlide(){this.showSlide(this.currentIndex-1)}update(e){this.paused||(this.timer+=e,this.timer>this.slideDuration&&(this.timer=0,this.currentIndex<o.memories.length-1&&this.nextSlide()))}draw(e){e.clear("#000")}resize(e,s){}exit(){this.eventListeners.forEach(({el:e,type:s,handler:t})=>{e.removeEventListener(s,t)}),this.eventListeners=[],h.hideScreen("slideshow-screen")}}export{p as SlideshowState};
