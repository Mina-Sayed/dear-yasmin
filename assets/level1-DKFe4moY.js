const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/codeGate-CrSWfrz-.js","assets/index-DtXWMLb9.js","assets/index-BuF_uRMX.css"])))=>i.map(i=>d[i]);
var y=Object.defineProperty;var m=(a,t,i)=>t in a?y(a,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[t]=i;var h=(a,t,i)=>m(a,typeof t!="symbol"?t+"":t,i);import{U as o,G as l,_ as p}from"./index-DtXWMLb9.js";class g{constructor(t){h(this,"sm");h(this,"player",{x:0,y:0,r:12,speed:250});h(this,"collectibles",[]);h(this,"collectedCount",0);h(this,"isPaused",!1);this.sm=t}enter(){o.showScreen("game-ui");const t=l.memories.length;o.updateHUD(`Collect all ${t} hearts! ❤️`),this.player.x=this.sm.renderer.width/2,this.player.y=this.sm.renderer.height/2,this.collectibles=l.memories.map(i=>{let e,s,n,r=0;do{e=50+Math.random()*(this.sm.renderer.width-50*2),s=50+Math.random()*(this.sm.renderer.height-50*2);const x=e-this.player.x,d=s-this.player.y;n=Math.sqrt(x*x+d*d),r++}while(n<100&&r<50);return{x:e,y:s,r:15,active:!0,id:i.id}}),this.collectedCount=0}update(t){if(this.isPaused)return;const i=this.sm.input.getAxis();(i.x!==0||i.y!==0)&&(this.player.x+=i.x*this.player.speed*t,this.player.y+=i.y*this.player.speed*t),this.player.x=Math.max(15,Math.min(this.sm.renderer.width-15,this.player.x)),this.player.y=Math.max(15,Math.min(this.sm.renderer.height-15,this.player.y)),this.collectibles.forEach(e=>{if(!e.active)return;const s=e.x,n=e.y+e.r/2,r=s-this.player.x,c=n-this.player.y;Math.sqrt(r*r+c*c)<this.player.r+e.r&&this.collect(e)})}collect(t){t.active=!1,this.collectedCount++,this.sm.audio.play("collect"),this.isPaused=!0;const i=l.memories.find(e=>e.id===t.id);o.showModal("Captured a Memory!",(i==null?void 0:i.img)||"",(i==null?void 0:i.text)||"",()=>{this.isPaused=!1,o.updateHUD(`Hearts: ${this.collectedCount}/${l.memories.length}`),this.collectedCount>=l.memories.length&&setTimeout(()=>{p(async()=>{const{CodeState:e}=await import("./codeGate-CrSWfrz-.js");return{CodeState:e}},__vite__mapDeps([0,1,2])).then(({CodeState:e})=>{this.sm.changeState(new e(this.sm))})},500)})}draw(t){t.clear("#1b1b2f"),t.ctx.strokeStyle="rgba(255,255,255,0.05)",t.ctx.lineWidth=1;const i=50;for(let e=0;e<t.width;e+=i)t.ctx.beginPath(),t.ctx.moveTo(e,0),t.ctx.lineTo(e,t.height),t.ctx.stroke();for(let e=0;e<t.height;e+=i)t.ctx.beginPath(),t.ctx.moveTo(0,e),t.ctx.lineTo(t.width,e),t.ctx.stroke();this.collectibles.forEach(e=>{if(!e.active)return;const s=Math.sin(Date.now()/200)*3;t.drawHeart(e.x,e.y,e.r*1.5+s,"#ff4081")}),t.ctx.shadowBlur=15,t.ctx.shadowColor="rgba(255, 255, 255, 0.5)",t.ctx.fillStyle="#fff",t.ctx.beginPath(),t.ctx.arc(this.player.x,this.player.y,this.player.r,0,Math.PI*2),t.ctx.fill(),t.ctx.shadowBlur=0,t.ctx.fillStyle="rgba(255,255,255,0.8)",t.ctx.font="14px Outfit",t.ctx.textAlign="center",t.ctx.fillText(l.heroName,this.player.x,this.player.y-25)}resize(t,i){this.player.x=Math.max(15,Math.min(t-15,this.player.x)),this.player.y=Math.max(15,Math.min(i-15,this.player.y)),this.collectibles.forEach(e=>{e.active&&(e.x=Math.max(50,Math.min(t-50,e.x)),e.y=Math.max(50,Math.min(i-50,e.y)))})}exit(){o.hideScreen("game-ui")}}export{g as Level1State};
